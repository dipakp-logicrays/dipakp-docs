{% extends "!layout.html" %}

{% block extrahead %}
    <!-- Content Security Policy for enhanced security -->
    {% if csp_policy %}
    <meta http-equiv="Content-Security-Policy" content="{{ csp_policy }}">
    {% endif %}

    <!-- Performance: DNS Prefetch & Preconnect -->
    {% if prefetch_resources %}
    {% for resource in prefetch_resources %}
    <link rel="dns-prefetch" href="{{ resource }}">
    <link rel="preconnect" href="{{ resource }}" crossorigin>
    {% endfor %}
    {% endif %}

    <!-- Performance: Preload critical resources -->
    {% if preload_resources %}
    {% for resource in preload_resources %}
    <link rel="preload" href="{{ resource.href }}" as="{{ resource.as }}"{% if resource.crossorigin %} crossorigin="{{ resource.crossorigin }}"{% endif %}>
    {% endfor %}
    {% endif %}

    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KB63FZ4D');</script>
    <!-- End Google Tag Manager -->

    <!-- Microsoft Clarity -->
    <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "tz6dkxiz3o");
    </script>
    <!-- End Microsoft Clarity -->

    <!-- Google Analytics 4 (GA4) - Now managed via GTM -->
    <!-- Note: You can manage GA4 through GTM dashboard instead of this code -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CRN8Y5Y7K7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-CRN8Y5Y7K7');
    </script>

    <!-- SEO Meta Tags -->
    {% set page_description = (meta.description if meta and meta.description else meta_description) | default('Documentation for Dipak Prajapati â€” Magento Developer, PHP, Docker, and Linux Tutorials. Learn Magento 2, Git, and development best practices.') %}
    {% set page_keywords = (meta.keywords if meta and meta.keywords else meta_keywords) | default('Magento 2, PHP, Docker, Linux, Git, Dipak Prajapati, Developer Docs, Magento Development, Web Development') %}
    {% set page_author = (meta.author if meta and meta.author else 'Dipak Prajapati') %}
    {% set page_title = title | striptags | escape %}
    {% set page_url = html_baseurl ~ pagename ~ '.html' %}

    <!-- Basic SEO Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="{{ page_description }}">
    <meta name="keywords" content="{{ page_keywords }}">
    <meta name="author" content="{{ page_author }}">
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="googlebot" content="index, follow">
    <meta name="bingbot" content="index, follow">
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">
    <meta name="rating" content="General">
    <meta name="distribution" content="global">
    <meta name="coverage" content="Worldwide">
    <meta name="target" content="all">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">

    <!-- Open Graph / Facebook Meta Tags -->
    <meta property="og:type" content="website">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="{{ docstitle | default('Logicrays Docs') }}">
    <meta property="og:title" content="{{ page_title }} - {{ docstitle | default('Logicrays Docs') }}">
    <meta property="og:description" content="{{ page_description }}">
    <meta property="og:url" content="{{ page_url }}">
    <meta property="og:image" content="{{ html_baseurl }}_static/logo.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="{{ page_title }}">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ page_title }} - {{ docstitle | default('Logicrays Docs') }}">
    <meta name="twitter:description" content="{{ page_description }}">
    <meta name="twitter:image" content="{{ html_baseurl }}_static/logo.png">
    <meta name="twitter:image:alt" content="{{ page_title }}">
    <meta name="twitter:creator" content="@DipakPrajapati">

    <!-- Structured Data (JSON-LD) for SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "TechArticle",
      "headline": "{{ page_title }}",
      "description": "{{ page_description }}",
      "author": {
        "@type": "Person",
        "name": "{{ page_author }}",
        "url": "https://dipakp-docs.readthedocs.io/"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Logicrays Technologies",
        "logo": {
          "@type": "ImageObject",
          "url": "{{ html_baseurl }}_static/logo.png"
        }
      },
      "datePublished": "2023-01-01",
      "dateModified": "{{ last_updated | default('2025-01-31') }}",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "{{ page_url }}"
      },
      "keywords": "{{ page_keywords }}",
      "inLanguage": "en-US",
      "isAccessibleForFree": true,
      "educationalUse": "instruction",
      "learningResourceType": "tutorial"
    }
    </script>

    <!-- Breadcrumb Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "{{ html_baseurl }}"
      }{% if parents %},
      {% for parent in parents %}{
        "@type": "ListItem",
        "position": {{ loop.index + 1 }},
        "name": "{{ parent.title }}",
        "item": "{{ html_baseurl }}{{ parent.link }}"
      }{% if not loop.last %},{% endif %}{% endfor %}{% endif %}]
    }
    </script>

    <!-- Website Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "{{ docstitle | default('Logicrays Docs') }}",
      "url": "{{ html_baseurl }}",
      "description": "{{ meta_description }}",
      "publisher": {
        "@type": "Organization",
        "name": "Logicrays Technologies"
      },
      "potentialAction": {
        "@type": "SearchAction",
        "target": "{{ html_baseurl }}search.html?q={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    }
    </script>

    <!-- Enable Read the Docs addons (including link preview) -->
    <meta name="readthedocs-addons-api-version" content="1" />

    <!-- Google Search Console verification -->
    {% if google_site_verification %}
    <meta name="google-site-verification" content="{{ google_site_verification }}" />
    {% endif %}

    <!-- Canonical URL -->
    <link rel="canonical" href="{{ page_url }}" />

    <!-- DNS Prefetch & Preconnect for Performance -->
    <link rel="dns-prefetch" href="//www.google-analytics.com">
    <link rel="preconnect" href="https://www.google-analytics.com" crossorigin>
    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>

    <!-- Theme Color for Mobile Browsers -->
    <meta name="theme-color" content="#2980B9">
    <meta name="msapplication-TileColor" content="#2980B9">
    <meta name="msapplication-navbutton-color" content="#2980B9">

    <!-- Alternate Languages (if you add translations later) -->
    <link rel="alternate" hreflang="en" href="{{ page_url }}" />
    <link rel="alternate" hreflang="x-default" href="{{ page_url }}" />

    <link href="{{ pathto("_static/custom.css", True) }}" rel="stylesheet" type="text/css">
{% endblock %}

{% block content %}
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KB63FZ4D"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
{{ super() }}
{% endblock %}